<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0, user-scalable=yes">
    <title>CINE'MO</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>C</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Work+Sans:wght@300;400;500&family=Archivo+Black&family=Noto+Sans+KR:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>
    <style>
    /* 모든 스타일은 styles.css로 이동했습니다 */
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="#" class="logo-link"><div class="logo">CINE<span>'MO</span></div></a>
            <div class="mobile-menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <nav>
                <ul>
                    <li><a href="socialring.html">소셜링</a></li>
                    <li><a href="festival.html">영화제</a></li>
                    <li><a href="production.html">제작</a></li>
                    <li><a href="gallery.html">갤러리</a></li>
                    <li><a href="curation.html">큐레이션</a></li>
                </ul>
            </nav>
            <div class="auth-buttons">
                <a href="#" class="buy-tickets" id="login-button"><span>로그인</span></a>
            </div>
        </div>
    </header>
    
    <!-- 로그인 모달 -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>로그인</h3>
            <form id="login-form">
                <div class="form-group">
                    <input type="email" id="login-email" name="email" placeholder="이메일" required>
                </div>
                <div class="form-group">
                    <input type="password" id="login-password" name="password" placeholder="비밀번호" required>
                </div>
                <div class="form-message" id="login-message"></div>
                <div class="form-button-center">
                    <button type="submit" class="cta-button">로그인</button>
                </div>
                <div class="form-footer">
                    <a href="#" class="signup-link" id="show-signup-modal">회원이 아니신가요? 가입하기</a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 회원가입 모달 -->
    <div id="signup-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>회원가입</h3>
            <form id="signup-form">
                <div class="form-group">
                    <input type="text" id="signup-name" name="name" placeholder="이름" required>
                </div>
                <div class="form-group">
                    <input type="email" id="signup-email" name="email" placeholder="이메일" required>
                </div>
                <div class="form-group">
                    <input type="password" id="signup-password" name="password" placeholder="비밀번호" required>
                </div>
                <div class="form-group">
                    <input type="password" id="signup-confirm-password" name="confirm-password" placeholder="비밀번호 확인" required>
                </div>
                <div class="form-message" id="signup-message"></div>
                <div class="form-button-center">
                    <button type="submit" class="cta-button">가입하기</button>
                </div>
                <div class="form-footer">
                    <a href="#" class="login-link" id="show-login-modal">이미 회원이신가요? 로그인하기</a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 로그아웃 알림 -->
    <div id="logout-notification" class="notification">
        <div class="notification-content">
            <p>정말 로그아웃 하시겠습니까?</p>
            <div class="notification-buttons">
                <button id="logout-cancel" class="notification-button secondary">취소</button>
                <button id="logout-confirm" class="notification-button">확인</button>
            </div>
        </div>
    </div>

    <main>
        <section id="intro" class="hero">
            <!-- 필름롤 GIF 배경 -->
            <img src="images/film_roll.gif" alt="Film Roll Background" class="film-background">
            
            <!-- 불투명 레이어 -->
            <div class="dark-overlay"></div>
            
            <div class="container hero-content">
                <div class="hero-text">
                    <p class="hero-tagline">영화를 사랑하는 모든 이들을 위한</p>
                    <h1 class="hero-title text-center">
                        <span class="highlight">영화. <span class="white-text">함께</span></span> 이야기하다
                    </h1>
                    <p class="hero-description">
                        CINE'MO는 영화 애호가들이 모여 경험을 공유하고, 새로운 영화를 발견하며, 영화계의 트렌드를 탐구하는 공간입니다.
                    </p>
                    <a href="socialring.html" class="cta-button">서비스 보기</a>
                </div>
            </div>
            
            <div class="curve"></div>
            <div class="circle"></div>
        </section>
        
        <section id="screening" class="screening-section">
            <div class="section-intro">
                <h2>특별 <span>상영회</span></h2>
                <p>CINE'MO에서 준비한 특별한 영화 상영 이벤트를 만나보세요</p>
            </div>
            <div class="container">
                <div class="screening-types">
                    <div class="screening-tab active" data-target="midnight">심야 상영회</div>
                    <div class="screening-tab" data-target="outdoor">야외 상영회</div>
                </div>
                
                <div class="screening-content">
                    <div id="midnight" class="screening-panel active">
                        <div class="midnight-intro">
                            <h3>심야 상영회</h3>
                            <p>밤의 감성으로 더욱 특별해지는 CINE'MO의 심야 상영 프로그램</p>
                        </div>
                        <div class="movie-cards">
                            <div class="movie-card">
                                <div class="movie-poster">
                                    <video autoplay muted loop playsinline>
                                        <source src="images/lounge.mp4" type="video/mp4">
                                    </video>
                                    <div class="movie-date">5월 25일 23:30</div>
                                </div>
                                <div class="movie-info">
                                    <h4>레토</h4>
                                    <p class="movie-director">키릴 세레브렌니코프</p>
                                    <p class="movie-synopsis">1980년대 초반, 소비에트 레닌그라드. 록음악은 서구에서 들어오고, 언더그라운드 록 씬이 꿈틀거린다.</p>
                                    <div class="movie-meta">
                                        <span>2018</span>
                                        <span>126분</span>
                                        <span>러시아</span>
                                    </div>
                                    <a href="#" class="cta-button small">예매하기</a>
                                </div>
                            </div>
                            <div class="movie-card">
                                <div class="movie-poster">
                                    <img src="images/test.png" alt="벌집의 정령 포스터">
                                    <div class="movie-date">6월 8일 23:30</div>
                                </div>
                                <div class="movie-info">
                                    <h4>벌집의 정령</h4>
                                    <p class="movie-director">빅토르 에리세</p>
                                    <p class="movie-synopsis">스페인 내전 직후, 어린 소녀 아나는 상상 속 정령을 만나게 된다.</p>
                                    <div class="movie-meta">
                                        <span>1973</span>
                                        <span>97분</span>
                                        <span>스페인</span>
                                    </div>
                                    <a href="#" class="cta-button small">예매하기</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="outdoor" class="screening-panel">
                        <div class="outdoor-intro">
                            <h3>야외 상영회 - 아트나인 특별 기획</h3>
                            <p>6월의 밤, 별빛 아래에서 즐기는 특별한 영화 경험</p>
                        </div>
                        <div class="outdoor-banner">
                            <img src="images/test5.png" alt="야외 상영회">
                            <div class="outdoor-overlay">
                                <h3>아트나인 야외 상영회</h3>
                                <p>6월 15일 - 30일</p>
                                <p>매주 금, 토, 일 20:00</p>
                            </div>
                        </div>
                        <div class="outdoor-schedule">
                            <div class="schedule-item">
                                <div class="schedule-date">6월 15일 (금)</div>
                                <div class="schedule-movie">
                                    <h4>벌집의 정령</h4>
                                    <p>빅토르 에리세 감독 | 97분 | 스페인</p>
                                </div>
                            </div>
                            <div class="schedule-item">
                                <div class="schedule-date">6월 16일 (토)</div>
                                <div class="schedule-movie">
                                    <h4>레토</h4>
                                    <p>키릴 세레브렌니코프 감독 | 126분 | 러시아</p>
                                </div>
                            </div>
                            <div class="schedule-item">
                                <div class="schedule-date">6월 17일 (일)</div>
                                <div class="schedule-movie">
                                    <h4>사랑의 행로</h4>
                                    <p>데이비드 린 감독 | 113분 | 영국</p>
                                </div>
                            </div>
                        </div>
                        <div class="outdoor-info">
                            <p>※ 우천시 실내에서 진행됩니다.</p>
                            <p>※ 돗자리와 간단한 음료 제공</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">CINE<span>'MO</span></div>
                <div class="footer-links">
                    <a href="socialring.html">소셜링</a>
                    <a href="festival.html">영화제</a>
                    <a href="production.html">제작</a>
                    <a href="gallery.html">갤러리</a>
                    <a href="curation.html">큐레이션</a>
                    <a href="#" id="footer-login">로그인</a>
                </div>
                <div class="social-links">
                    <a href="#" class="social-link">Instagram</a>
                    <a href="#" class="social-link">Twitter</a>
                    <a href="#" class="social-link">YouTube</a>
                </div>
            </div>
            <div class="copyright">
                © 2025 CINE'MO. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 기본 애니메이션 효과 
            gsap.registerPlugin(ScrollTrigger);
            
            // 모바일 메뉴 토글 기능
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            const nav = document.querySelector('nav');
            
            if(mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    nav.classList.toggle('active');
                    // 스크롤 방지
                    if(nav.classList.contains('active')) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });
                
                // 모바일 메뉴 링크 클릭 시 메뉴 닫기
                const navLinks = document.querySelectorAll('nav a');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenuToggle.classList.remove('active');
                        nav.classList.remove('active');
                        document.body.style.overflow = '';
                    });
                });
            }
            
            // 스크롤 시 헤더 스타일 변경
            const header = document.querySelector('header');
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
            
            // 인트로 애니메이션
            gsap.from('.hero-content', {
                opacity: 0,
                y: 30,
                duration: 1,
                delay: 0.5,
                ease: 'power3.out'
            });

            // 상영회 탭 전환 기능
            const screeningTabs = document.querySelectorAll('.screening-tab');
            const screeningPanels = document.querySelectorAll('.screening-panel');
            
            screeningTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    
                    // 탭 활성화 상태 변경
                    screeningTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 패널 활성화 상태 변경
                    screeningPanels.forEach(panel => {
                        panel.classList.remove('active');
                        if (panel.id === target) {
                            panel.classList.add('active');
                        }
                    });
                });
            });

            // 모든 링크 스크롤 함수 정의
            function smoothScroll(targetElement) {
                if (targetElement) {
                    // 헤더 높이 계산
                    const headerHeight = document.querySelector('header').offsetHeight;
                    
                    // 모바일에서는 추가 여백 제공
                    const isMobile = window.innerWidth <= 768;
                    const mobileOffset = isMobile ? 50 : 30;
                    
                    // 요소의 실제 위치 계산
                    const elementPosition = targetElement.getBoundingClientRect().top + window.scrollY;
                    const offsetPosition = elementPosition - headerHeight - mobileOffset;
                    
                    // 스크롤 이동
                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            }

            // 모달 관련 기능
            const loginButton = document.getElementById('login-button');
            const loginModal = document.getElementById('login-modal');
            const signupModal = document.getElementById('signup-modal');
            const closeModalButtons = document.querySelectorAll('.close-modal');
            const showSignupModalButton = document.getElementById('show-signup-modal');
            const showLoginModalButton = document.getElementById('show-login-modal');
            
            // 로그인 버튼 클릭 시 로그인 모달 표시
            loginButton.addEventListener('click', function(e) {
                e.preventDefault();
                loginModal.style.display = 'flex';
            });
            
            // 회원가입 링크 클릭 시 회원가입 모달 표시, 로그인 모달 숨김
            showSignupModalButton.addEventListener('click', function(e) {
                e.preventDefault();
                loginModal.style.display = 'none';
                signupModal.style.display = 'flex';
            });
            
            // 로그인 링크 클릭 시 로그인 모달 표시, 회원가입 모달 숨김
            showLoginModalButton.addEventListener('click', function(e) {
                e.preventDefault();
                signupModal.style.display = 'none';
                loginModal.style.display = 'flex';
            });
            
            // 모달 닫기 버튼 클릭 시 모달 숨김
            closeModalButtons.forEach(button => {
                button.addEventListener('click', function() {
                    loginModal.style.display = 'none';
                    signupModal.style.display = 'none';
                });
            });
            
            // 모달 외부 클릭 시 모달 숨김
            window.addEventListener('click', function(e) {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (e.target === signupModal) {
                    signupModal.style.display = 'none';
                }
            });
            
            // 회원가입 폼 제출 처리
            const signupForm = document.getElementById('signup-form');
            const signupMessage = document.getElementById('signup-message');
            
            signupForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('signup-name').value;
                const email = document.getElementById('signup-email').value;
                const password = document.getElementById('signup-password').value;
                const confirmPassword = document.getElementById('signup-confirm-password').value;
                
                // 비밀번호 확인
                if (password !== confirmPassword) {
                    signupMessage.textContent = '비밀번호가 일치하지 않습니다.';
                    signupMessage.className = 'form-message error';
                    return;
                }
                
                // 서버에 회원가입 요청
                fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name, email, password })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        signupMessage.textContent = '회원가입이 완료되었습니다!';
                        signupMessage.className = 'form-message success';
                        
                        // 폼 초기화
                        signupForm.reset();
                        
                        // 3초 후 로그인 모달로 전환
                        setTimeout(() => {
                            signupModal.style.display = 'none';
                            loginModal.style.display = 'flex';
                            signupMessage.textContent = '';
                        }, 3000);
                    } else {
                        signupMessage.textContent = data.message || '회원가입 중 오류가 발생했습니다.';
                        signupMessage.className = 'form-message error';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    signupMessage.textContent = '서버와의 통신 중 오류가 발생했습니다.';
                    signupMessage.className = 'form-message error';
                });
            });
            
            // 로그인 폼 제출 처리
            const loginForm = document.getElementById('login-form');
            const loginMessage = document.getElementById('login-message');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                
                // 서버에 로그인 요청
                fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        loginMessage.textContent = '로그인 성공!';
                        loginMessage.className = 'form-message success';
                        
                        // 토큰 저장
                        localStorage.setItem('token', data.token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                        localStorage.setItem('isLoggedIn', 'true');
                        
                        // 로그인 상태 업데이트
                        updateAuthUI(true, data.user.name);
                        
                        // 폼 초기화
                        loginForm.reset();
                        
                        // 2초 후 모달 닫기
                        setTimeout(() => {
                            loginModal.style.display = 'none';
                            loginMessage.textContent = '';
                        }, 2000);
                    } else {
                        loginMessage.textContent = data.message || '로그인 중 오류가 발생했습니다.';
                        loginMessage.className = 'form-message error';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    loginMessage.textContent = '서버와의 통신 중 오류가 발생했습니다.';
                    loginMessage.className = 'form-message error';
                });
            });
            
            // 인증 상태에 따른 UI 업데이트 함수
            function updateAuthUI(isLoggedIn, username) {
                const headerLoginButton = document.getElementById('login-button');
                const footerLoginBtn = document.getElementById('footer-login');
                
                if (isLoggedIn) {
                    // 헤더 로그인 버튼 변경
                    if (headerLoginButton) {
                        headerLoginButton.querySelector('span').textContent = '로그아웃';
                        
                        // 이전 이벤트 리스너 제거 (클론 후 교체 방식으로 확실하게)
                        const newButton = headerLoginButton.cloneNode(true);
                        headerLoginButton.parentNode.replaceChild(newButton, headerLoginButton);
                        
                        // 로그아웃 이벤트 리스너 추가
                        newButton.addEventListener('click', function(e) {
                            e.preventDefault();
                            document.getElementById('logout-notification').style.display = 'flex';
                        });
                    }
                    
                    // 푸터 로그인 링크 변경
                    if (footerLoginBtn) {
                        footerLoginBtn.textContent = '로그아웃';
                        
                        // 이전 이벤트 리스너 제거
                        const newFooterBtn = footerLoginBtn.cloneNode(true);
                        footerLoginBtn.parentNode.replaceChild(newFooterBtn, footerLoginBtn);
                        
                        // 푸터 로그아웃 버튼 클릭 이벤트
                        newFooterBtn.addEventListener('click', function(e) {
                            e.preventDefault();
                            document.getElementById('logout-notification').style.display = 'flex';
                        });
                    }
                } else {
                    // 헤더 로그인 버튼 변경
                    if (headerLoginButton) {
                        headerLoginButton.querySelector('span').textContent = '로그인';
                        
                        // 이전 이벤트 리스너 제거 (클론 후 교체 방식으로 확실하게)
                        const newButton = headerLoginButton.cloneNode(true);
                        headerLoginButton.parentNode.replaceChild(newButton, headerLoginButton);
                        
                        // 로그인 이벤트 리스너 추가
                        newButton.addEventListener('click', function(e) {
                            e.preventDefault();
                            loginModal.style.display = 'flex';
                        });
                    }
                    
                    // 푸터 로그인 링크 변경
                    if (footerLoginBtn) {
                        footerLoginBtn.textContent = '로그인';
                        
                        // 이전 이벤트 리스너 제거
                        const newFooterBtn = footerLoginBtn.cloneNode(true);
                        footerLoginBtn.parentNode.replaceChild(newFooterBtn, footerLoginBtn);
                        
                        // 푸터 로그인 버튼 클릭 이벤트
                        newFooterBtn.addEventListener('click', function(e) {
                            e.preventDefault();
                            loginModal.style.display = 'flex';
                        });
                    }
                }
            }
            
            // 로그아웃 처리
            const logoutCancelBtn = document.getElementById('logout-cancel');
            const logoutConfirmBtn = document.getElementById('logout-confirm');
            const logoutNotification = document.getElementById('logout-notification');
            
            if (logoutCancelBtn) {
                logoutCancelBtn.addEventListener('click', function() {
                    logoutNotification.style.display = 'none';
                });
            }
            
            if (logoutConfirmBtn) {
                logoutConfirmBtn.addEventListener('click', function() {
                    // 로그아웃 처리
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    localStorage.setItem('isLoggedIn', 'false');
                    
                    // 알림 닫기
                    logoutNotification.style.display = 'none';
                    
                    // UI 업데이트
                    updateAuthUI(false);
                    
                    // 페이지 상단으로 이동
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }
            
            // 페이지 로드 시 로그인 상태 확인
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            if (isLoggedIn) {
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                updateAuthUI(true, user.name);
            } else {
                updateAuthUI(false);
            }
        });
    </script>
</body>
</html>